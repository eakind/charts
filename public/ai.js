!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ai",[],e):"object"==typeof exports?exports.ai=e():t.ai=e()}(window,(function(){return function(t){var e={};function a(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=t,a.c=e,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(r,i,function(e){return t[e]}.bind(null,i));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){"use strict";a.r(e);const r=function(t){let e,a,r,i={bindto:"#chart",font_size:12,size_width:400,size_height:400,rotate:!1,type:"category",divide_show:!1,divide_color:"grey",divide_width:1,x_name:"",x_grid_show:!1,x_grid_color:"grey",x_grid_width:1,x_axis_line_show:!0,x_axis_line_color:"black",x_axis_line_width:1,x_axis_ticks_show:!0,x_axis_ticks_color:"grey",x_axis_title_show:!0,x_axis_title_color:"black",y_grid_show:!0,y_grid_color:"grey",y_grid_width:1,y_axis_scale:1,y_axis_line_show:!0,y_axis_line_color:"black",y_axis_line_width:1,y_axis_ticks_show:!0,y_axis_ticks_color:"grey",y_axis_title_show:!0,y_axis_title_color:"black",x_axis_hide:0,y2_axis_line_show:!0,y2_axis_line_color:"black",y2_axis_line_width:1,y2_axis_ticks_show:!0,y2_axis_ticks_color:"grey",y2_axis_title_show:!0,y2_axis_title_color:"black",tooltip_background:"white",tooltip_color:"black",tooltip_content_title:"",tooltip_content_value:"",padding_left:50,padding_right:10,padding_top:10,padding_bottom:50,data:[],combined:[]};const o=()=>{const t=a.shift();return t&&e&&"object"==typeof e&&t in e?(e=e[t],o()):t?void 0:e};return Object.keys(i).forEach(n=>{e=t,a=n.split("_"),r=o(),void 0!==r&&(i[n]=r)}),i};a.d(e,"generate",(function(){return o}));class i{constructor(t){this.config=r(t)}draw(){let{bindto:t,font_size:e,size_width:a,size_height:r,rotate:i,type:o,divide_show:n,divide_color:l,divide_width:s,x_name:d,x_grid_show:c,x_grid_color:_,x_grid_width:p,x_axis_line_show:x,x_axis_line_color:y,x_axis_line_width:f,x_axis_ticks_show:h,x_axis_ticks_color:u,x_axis_title_show:g,x_axis_title_color:m,x_axis_hide:w,y_grid_show:b,y_grid_color:v,y_grid_width:k,y_axis_scale:$,y_axis_line_show:j,y_axis_line_color:A,y_axis_line_width:z,y_axis_ticks_show:O,y_axis_ticks_color:S,y_axis_title_show:T,y_axis_title_color:L,y2_axis_line_show:E,y2_axis_line_color:M,y2_axis_line_width:P,y2_axis_ticks_show:F,y2_axis_ticks_color:B,y2_axis_title_show:C,y2_axis_title_color:N,tooltip_background:q,tooltip_color:X,tooltip_content_title:Y,tooltip_content_value:Z,padding_left:R,padding_right:D,padding_top:G,padding_bottom:H,data:I,combined:J}=this.config,K=a-R-D,Q=r-G-H,U=d3.select(t);U.html("");let V,W,tt,et=U.append("svg").attr("width",a).attr("height",r),at=U.append("div").attr("class","tooltip").attr("style",()=>`\n                      border: 1px solid #fff; \n                      background-color: ${q}; \n                      color: ${X};\n                      box-shadow: 0 1px 3px rgba(0,0,0,0.4); \n                      border-radius: 3px; \n                      padding: 6px; \n                      font-size: ${e}px; \n                      position: absolute;\n                      z-index: 10;\n                      opacity: 0\n                    `),rt=et.append("g").attr("class","group-x-axis"),it=et.append("g").attr("class","group-y-axis"),ot=et.append("g").attr("class","group-y2-axis"),nt=et.append("g").attr("class","group-main"),lt=nt.append("g").attr("class","group_x_grid"),st=nt.append("g").attr("class","group_y_grid"),dt=K,ct=Q,_t=[0,K],pt=[0,-Q],xt=d3.axisBottom,yt=d3.axisLeft,ft=d3.axisRight,ht={x:K,y:H-5,rotate:0,anchor:"end"},ut={x:5-R,y:-Q,rotate:90,anchor:"start"},gt={x:D-10,y:-Q,rotate:90,anchor:"start"};i?(dt=Q,ct=K,_t=[0,Q],pt=[0,K],xt=d3.axisLeft,yt=d3.axisTop,ft=d3.axisBottom,ht={x:5-R,y:0,rotate:90,anchor:"start"},ut={x:K,y:10-G,rotate:0,anchor:"end"},gt={x:K,y:Q,rotate:0,anchor:"end"},rt.attr("transform",`translate(${R}, ${G})`),it.attr("transform",`translate(${R}, ${G})`),ot.attr("transform",`translate(${R}, ${r-H})`),nt.attr("transform",`translate(${R}, ${G+Q})`)):(rt.attr("transform",`translate(${R}, ${r-H})`),it.attr("transform",`translate(${R}, ${r-H})`),ot.attr("transform",`translate(${a-D}, ${r-H})`),nt.attr("transform",`translate(${R}, ${G+Q})`));let mt="category"===o;if(mt){let t=Array.from(new Set(I.map(t=>t[d])));V=d3.scaleBand().domain(t).range(_t)}else if("bin"===o){let t=d3.max(I,t=>t.end),e=d3.min(I,t=>t.start);e>0&&(e=0),V=d3.scaleLinear().domain([e,t]).range(_t).nice()}else{let t=d3.extent(I,t=>t[d]);t[0]>0&&(t[0]=0),V=d3.scaleLinear().domain(t).range(_t).nice()}let wt=[],bt=[],vt=[],kt=[];J.forEach(t=>{let{type:e,name:a,axis:r,style:i}=t;if("y"===r){let t=d3.extent(I,t=>t[a]);(void 0===wt[0]||wt[0]>t[0])&&(wt[0]=t[0]),(void 0===wt[1]||wt[1]<t[1])&&(wt[1]=t[1]),wt[0]>0&&(wt[0]=0),wt[1]*=$,vt.push(a)}if("y2"===r){let t=d3.extent(I,t=>t[a]);(void 0===bt[0]||bt[0]>t[0])&&(bt[0]=t[0]),(void 0===bt[1]||bt[1]<t[1])&&(bt[1]=t[1]),bt[0]>0&&(bt[0]=0),bt[1]*=$,kt.push(a)}}),W=d3.scaleLinear().domain(wt).range(pt).nice(),tt=d3.scaleLinear().domain(bt).range(pt).nice(),vt=vt.join(" & "),kt=kt.join(" & "),rt.call(xt(V)).select("path").attr("stroke",x?y:"transparent").attr("stroke-width",f),rt.selectAll("line").attr("stroke","transparent"),rt.selectAll("text").attr("fill",h?u:"transparent").text((function(t,e){return w&&e%w?"":isNaN(t)?t.length>20?t.substring(0,20)+"...":t:t.length>10?parseFloat(t).toExponential(3):parseFloat(t)})),g&&rt.append("text").attr("transform",`translate(${ht.x}, ${ht.y})rotate(${ht.rotate})`).attr("text-anchor",ht.anchor).text(d).attr("fill",m),c&&lt.call(xt(V).tickSize(-ct).tickFormat("")).selectAll("line").attr("stroke",(t,e)=>e||mt?_:"transparent").attr("stroke-width",p),lt.select("path").attr("stroke","transparent"),it.call(yt(W)).select("path").attr("stroke",j?A:"transparent").attr("stroke-width",z),it.selectAll("line").attr("stroke","transparent"),it.selectAll("text").attr("fill",O?S:"transparent"),T&&it.append("text").attr("transform",`translate(${ut.x}, ${ut.y})rotate(${ut.rotate})`).attr("text-anchor",ut.anchor).text(vt).attr("fill",L),b&&st.call(yt(W).tickSize(i?dt:-dt).tickFormat("")).selectAll("line").attr("stroke",(t,e)=>e?v:"transparent").attr("stroke-width",k),st.select("path").attr("stroke","transparent"),bt.length&&(ot.call(ft(tt)).select("path").attr("stroke",E?M:"transparent").attr("stroke-width",P),ot.selectAll("line").attr("stroke","transparent"),ot.selectAll("text").attr("fill",F?B:"transparent"),C&&ot.append("text").attr("transform",`translate(${gt.x}, ${gt.y})rotate(${gt.rotate})`).attr("text-anchor",gt.anchor).text(kt).attr("fill",N)),n&&nt.append("g").attr("class","divide-line").append("line").attr("stroke",l).attr("stroke-width",s).attr("x1",0).attr("y1",0).attr("x2",K).attr("y2",-Q);let $t=J.filter(t=>"bar"===t.type),jt=J.filter(t=>"line"===t.type),At=mt?V.bandwidth():0;nt.append("g").attr("class","main-bars").selectAll(".group").data($t).enter().append("g").attr("class","group").each((function(t){let e=t.style.band-2*t.style.padding,a=t.style.radius,r=d3.local(),o=d3.select(this).append("g").selectAll(".rect").data(I).enter().append("g").attr("class","rect").each((function(o){let n,l,s,c,_,p;i?(p=o[t.name]<0,l=V(o[d])+At/2-Q,s=o[t.name]<0?W(0)-W(o[t.name]):W(o[t.name])-W(0),s=Math.max(s-2*a,0),n=o[t.name]>0?W(0):W(0)-s,c=e,_=`translate(0, ${-e/2})`):(n=V(o[d])+At/2,l=o[t.name]>0?W(o[t.name]):W(0),s=e,c=o[t.name]>0?W(0)-W(o[t.name]):W(o[t.name])-W(0),_=`translate(${-e/2}, 0)`),r.set(this,{x:n,y:l,w:s,h:c,transform:_,lessThenZero:p})}));if(o.append("rect").attr("x",(function(){return r.get(this).x})).attr("y",(function(){return r.get(this).y})).attr("width",(function(){return r.get(this).w})).attr("height",(function(){return r.get(this).h})).attr("transform",(function(){return r.get(this).transform})).attr("fill",t.style.fill).on("mouseenter",e=>{let a="";Object.keys(e).forEach(r=>{if(t.tooltip){let r=t.tooltip.value,i=t.tooltip.title,o=t.tooltip.range;a=o?`<div>${o}: ${e[o]} </div><div>${i?e[i]:r}: ${e[r]}</div>`:`<div>${i?e[i]:r}: ${e[r]}</div>`,"缺失"===e[o]&&(a=`<div>${e[o]}:${e[r]}</div>`)}else a+=`<div>${r}: ${e[r]}</div>`}),at.html(a).style("opacity",1).style("display","block").style("left",()=>d3.event.offsetX+10+"px").style("top",()=>d3.event.offsetY+"px")}).on("mouseout",()=>{at.style("opacity",0).style("display","none")}),a){let e=d3.line().curve(d3.curveNatural);o.append("path").attr("transform",(function(){return r.get(this).transform})).attr("d",(function(){let{x:t,y:o,w:n,h:l,lessThenZero:s}=r.get(this);if(i){if(n<=0)return;let r=[];return r=s?[[t,o],[t-1.5*a,o+l/4],[t-2*a,o+l/2],[t-1.5*a,o+l/4*3],[t,o+l]]:[[t+n,o],[t+n+1.5*a,o+l/4],[t+n+2*a,o+l/2],[t+n+1.5*a,o+l/4*3],[t+n,o+l]],e(r)}})).attr("fill",t.style.fill)}})),nt.append("g").attr("class","main-lines").selectAll(".group").data(jt).enter().append("g").attr("class","group").each((function(t){let e="y"===t.axis?W:tt,a=t.style.interpolate,{color:r,size:i,type:o}=t.style.point,n=t.style.stroke.color,l=t.style.stroke.width,s="";s="cross"===o?d3.symbolCross:"triangle"===o?d3.symbolTriangle:"square"===o?d3.symbolSquare:d3.symbolCircle;let c=d3.symbol().type(s).size(i),_=d3.line().defined(t=>void 0!==t).x(t=>V(t[d])+At/2).y((a,r)=>(e(a[t.name])));a&&_.curve(d3.curveCardinal),d3.select(this).append("path").attr("d",_(I)).attr("fill","none").attr("stroke",n).attr("stroke-width",l),""!==s&&d3.select(this).append("g").selectAll("path").data(I).enter().append("path").attr("d",c).attr("fill",e=>{if(e.noTip===t.name){return r.split(")")[0]+", 0)"}return r}).attr("transform",a=>`translate(${V(a[d])+At/2}, ${e(a[t.name])})`).on("mouseenter",e=>{let a="";Object.keys(e).forEach(r=>{if(e.noTip!==t.name){if(t.tooltip){let r=t.tooltip.value,i=t.tooltip.title,o=t.tooltip.range;a=o?`<div>${o}: ${e[o]} </div><div>${i?e[i]:r}: ${e[r]}</div>`:`<div>${i?e[i]:r}: ${e[r]}</div>`}else a+=`<div>${r}: ${e[r]}</div>`;at.html(a).style("opacity",1).style("display","block").style("left",()=>d3.event.offsetX+10+"px").style("top",()=>d3.event.offsetY+"px")}})}).on("mouseout",()=>{at.style("opacity",0).style("display","none")})})),et.selectAll("text").attr("font-size",e)}}const o=function(t){new i(t).draw()};e.default=o}])}));